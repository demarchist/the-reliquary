---
import BaseLayout from '../layouts/BaseLayout.astro';
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
---

<BaseLayout title="Search">
  <h1 class="font-serif text-3xl font-bold text-ink-900 mb-2">Search</h1>
  <p class="text-ink-400 mb-8">Search across all diary entries and wiki articles.</p>

  <div id="search" class="pagefind-ui-container"></div>

  <link href={`${base}/pagefind/pagefind-ui.css`} rel="stylesheet" />
  <script define:vars={{ base }}>
    window.__pagefindBase = base;
  </script>
  <script>
    async function initPagefind() {
      const base = window.__pagefindBase || '';
      const { PagefindUI } = await import(`${base}/pagefind/pagefind-ui.js`);
      new PagefindUI({
        element: '#search',
        showSubResults: true,
        showImages: false,
        baseUrl: `${base}/`,
      });
    }
    initPagefind();
  </script>
</BaseLayout>

<style is:global>
  .pagefind-ui-container {
    --pagefind-ui-scale: 1;
    --pagefind-ui-primary: var(--color-accent-600);
    --pagefind-ui-text: var(--color-ink-800);
    --pagefind-ui-background: var(--color-parchment-50);
    --pagefind-ui-border: var(--color-parchment-300);
    --pagefind-ui-tag: var(--color-parchment-200);
    --pagefind-ui-border-width: 1px;
    --pagefind-ui-border-radius: 8px;
    --pagefind-ui-font: var(--font-sans);
  }

  .pagefind-ui .pagefind-ui__search-input {
    font-family: var(--font-sans);
    background: var(--color-parchment-100);
  }

  .pagefind-ui .pagefind-ui__result-link {
    color: var(--color-accent-600);
    font-family: var(--font-serif);
  }

  .pagefind-ui .pagefind-ui__result-link:hover {
    color: var(--color-accent-700);
  }

  .pagefind-ui .pagefind-ui__result-excerpt {
    color: var(--color-ink-500);
  }
</style>
